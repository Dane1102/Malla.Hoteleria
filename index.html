<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Malla Curricular - Hotelería</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    .malla {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }
    .anio {
      background: #fdf2f8;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      min-width: 200px;
    }
    .anio h2 {
      text-align: center;
      font-size: 18px;
      color: #c94f7c;
    }
    .materia {
      background: #e3f2fd;
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      position: relative;
      transition: 0.3s ease;
    }
    .materia.aprobada {
      background: #c8e6c9;
      text-decoration: line-through;
    }
    .materia.bloqueada {
      background: #f8d7da;
      cursor: not-allowed;
      opacity: 0.6;
    }
    .materia.bloqueada::after {
      content: attr(data-tooltip);
      position: absolute;
      background: #555;
      color: #fff;
      padding: 5px;
      font-size: 12px;
      border-radius: 4px;
      top: 50%;
      left: 105%;
      transform: translateY(-50%);
      white-space: nowrap;
      display: none;
      z-index: 10;
    }
    .materia.bloqueada:hover::after {
      display: block;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Hotelería</h1>
  <div class="malla" id="malla"></div>

  <script>
    const materias = [
      { id: "m1", nombre: "Introducción al Turismo", ciclo: "1º Año - Ciclo 1", prerequisitos: [] },
      { id: "m2", nombre: "Comunicación Oral y Escrita", ciclo: "1º Año - Ciclo 1", prerequisitos: [] },
      { id: "m3", nombre: "Fundamentos de Hotelería", ciclo: "1º Año - Ciclo 1", prerequisitos: [] },
      { id: "m4", nombre: "Atención al Cliente", ciclo: "1º Año - Ciclo 2", prerequisitos: ["m2"] },
      { id: "m5", nombre: "Operaciones Hotelera", ciclo: "1º Año - Ciclo 2", prerequisitos: ["m3"] },
      { id: "m6", nombre: "Turismo Sostenible", ciclo: "2º Año - Ciclo 1", prerequisitos: ["m1"] },
      { id: "m7", nombre: "Marketing Turístico", ciclo: "2º Año - Ciclo 1", prerequisitos: ["m4"] },
      { id: "m8", nombre: "Gestión de Eventos", ciclo: "2º Año - Ciclo 2", prerequisitos: ["m5", "m7"] },
      { id: "m9", nombre: "Práctica Profesional", ciclo: "3º Año - Ciclo 1", prerequisitos: ["m6", "m8"] },
    ];

    const estado = JSON.parse(localStorage.getItem("estadoMaterias")) || {};

    function guardarEstado() {
      localStorage.setItem("estadoMaterias", JSON.stringify(estado));
    }

    function crearMalla() {
      const contenedor = document.getElementById("malla");
      contenedor.innerHTML = "";

      const ciclosUnicos = [...new Set(materias.map(m => m.ciclo))];

      ciclosUnicos.forEach(ciclo => {
        const columna = document.createElement("div");
        columna.className = "anio";
        const titulo = document.createElement("h2");
        titulo.textContent = ciclo;
        columna.appendChild(titulo);

        materias
          .filter(m => m.ciclo === ciclo)
          .forEach(materia => {
            const div = document.createElement("div");
            div.className = "materia";
            div.textContent = materia.nombre;

            const aprobada = estado[materia.id];
            const requisitosCumplidos = materia.prerequisitos.every(pr => estado[pr]);

            if (aprobada) {
              div.classList.add("aprobada");
            } else if (!requisitosCumplidos) {
              div.classList.add("bloqueada");
              const faltan = materia.prerequisitos.filter(pr => !estado[pr]);
              const nombresFaltantes = faltan.map(id => materias.find(m => m.id === id).nombre);
              div.setAttribute("data-tooltip", "Faltan: " + nombresFaltantes.join(", "));
            }

            div.addEventListener("click", () => {
              if (div.classList.contains("bloqueada")) return;
              estado[materia.id] = !estado[materia.id];
              guardarEstado();
              crearMalla();
            });

            columna.appendChild(div);
          });

        contenedor.appendChild(columna);
      });
    }

    crearMalla();
  </script>
</body>
</html>
